<style>body{margin:0;padding:0}#c{margin:0;padding:0;background:#deffff}</style><canvas id=c width=1360 height=760></canvas><script>!function(){let t=(t,i,s,h,e,r,n,a)=>{let k=((t,i)=>([t,i]=[t,i].map(t=>({x:[t.x1,t.x2].sort(),y:[t.y1,t.y2].sort()})),!(i.x[0]>t.x[1]||i.x[1]<t.x[0]||i.y[0]>t.y[1]||i.y[1]<t.y[0])&&{x1:Math.max(t.x[0],i.x[0]),y1:Math.max(t.y[0],i.y[0]),x2:Math.min(t.x[1],i.x[1]),y2:Math.min(t.y[1],i.y[1])}))({x1:t,y1:i,x2:t+s,y2:i+h},{x1:e,y1:r,x2:e+n,y2:r+a});if(k){let t=Math.abs(n*a/100),i=Math.abs((k.x2-k.x1)*(k.y2-k.y1));return i>0&&t>0?i/t:0}return 0},i=(t,i,s,h,e,r,n)=>{r&&(t.font="bold "+r+"px Arial"),n&&(t.textAlign="center"),t.fillStyle=e,t.fillText(i,s,h)},s=(t,i,s,h,e,r,n)=>{const a=2*Math.PI-e*Math.PI/180;t.save(),t.translate(s,h),t.rotate(a),t.translate(-r,-n),t.drawImage(i,0,0),t.restore()},h=(t,i,s,h,e,r,n,a,k,o)=>{t.save(),void 0===e&&(e=i.width),void 0===r&&(r=i.height),void 0===o&&(o=!1),o&&(s-=e/2,h-=r/2),t.translate(s+e/2,h+r/2),t.rotate(2*Math.PI-n*Math.PI/180);let c=0,l=0;c=a?-1:1,k?(l=k,c=k):l=1,t.scale(c,l),t.drawImage(i,-e/2,-r/2,e,r),t.restore()},e=()=>(new Date).getTime(),r=(t,i)=>Math.floor(Math.random()*(i-t+1))+t;const n=t=>Math.PI/180*t;let a={};function k(){this.M=function(t){for(var i=0;i<24;i++)this[String.fromCharCode(97+i)]=t[i]||0;this.c<.01&&(this.c=.01);var s=this.b+this.c+this.e;if(s<.18){var h=.18/s;this.b*=h,this.c*=h,this.e*=h}}}var o=new function(){var t,i,s,h,e,r,n,a,o,c,l,d;this.A=new k,this.reset=function(){var t=this.A;h=100/(t.f*t.f+.001),e=100/(t.g*t.g+.001),r=1-t.h*t.h*t.h*.01,n=-t.i*t.i*t.i*1e-6,t.a||(l=.5-t.n/2,d=5e-5*-t.o),a=1+t.l*t.l*(t.l>0?-.9:10),o=0,c=1==t.m?0:(1-t.m)*(1-t.m)*2e4+32},this.G=function(){this.reset();var h=this.A;return 3*(((t=h.b*h.b*1e5)+(i=h.c*h.c*1e5)+(s=h.e*h.e*1e5+12))/3|0)},this.I=function(k,f){var u=this.A,x=1!=u.s||u.v,b=u.v*u.v*.1,w=1+3e-4*u.w,p=u.s*u.s*u.s*.1,v=1+1e-4*u.t,g=1!=u.s,M=u.x*u.x,m=u.g,E=u.q||u.r,y=u.r*u.r*u.r*.2,A=u.q*u.q*(u.q<0?-1020:1020),G=u.p?32+((1-u.p)*(1-u.p)*2e4|0):0,I=u.d,T=u.j/2,C=u.k*u.k*.01,S=u.a,H=t,D=1/t,N=1/i,O=1/s,R=5/(1+u.u*u.u*20)*(.01+p);R>.8&&(R=.8),R=1-R;for(var L,B,F,P,U,$,j=!1,K=0,V=0,W=0,Y=0,z=0,q=0,X=0,J=0,Q=0,Z=0,_=Array(1024),tt=Array(32),it=_.length;it--;)_[it]=0;for(it=tt.length;it--;)tt[it]=2*Math.random()-1;for(it=0;it<f;it++){if(j)return it;if(G&&++Q>=G&&(Q=0,this.reset()),c&&++o>=c&&(c=0,h*=a),(h*=r+=n)>e&&(h=e,m>0&&(j=!0)),B=h,T>0&&(B*=1+Math.sin(Z+=C)*T),(B|=0)<8&&(B=8),S||((l+=d)<0?l=0:l>.5&&(l=.5)),++V>H)switch(V=0,++K){case 1:H=i;break;case 2:H=s}switch(K){case 0:W=V*D;break;case 1:W=1+2*(1-V*N)*I;break;case 2:W=1-V*O;break;case 3:W=0,j=!0}E&&((F=0|(A+=y))<0?F=-F:F>1023&&(F=1023)),x&&w&&((b*=w)<1e-5?b=1e-5:b>.1&&(b=.1)),$=0;for(var st=8;st--;){if(++X>=B&&(X%=B,3==S))for(var ht=tt.length;ht--;)tt[ht]=2*Math.random()-1;switch(S){case 0:U=X/B<l?.5:-.5;break;case 1:U=1-X/B*2;break;case 2:U=.225*(((U=1.27323954*(P=6.28318531*((P=X/B)>.5?P-1:P))+.405284735*P*P*(P<0?1:-1))<0?-1:1)*U*U-U)+U;break;case 3:U=tt[Math.abs(32*X/B|0)]}x&&(L=q,(p*=v)<0?p=0:p>.1&&(p=.1),g?(z+=(U-q)*p,z*=R):(q=U,z=0),Y+=(q+=z)-L,U=Y*=1-b),E&&(_[J%1024]=U,U+=_[(J-F+1024)%1024],J++),$+=U}k[it]=($*=.125*W*M)>=1?32767:$<=-1?-32768:32767*$|0}return f}};a=(t=>{o.A.M(t);var i=o.G(),s=new Uint8Array(4*((i+1)/2|0)+44),h=2*o.I(new Uint16Array(s.buffer,44),i),e=new Uint32Array(s.buffer,0,44);e[0]=1179011410,e[1]=h+36,e[2]=1163280727,e[3]=544501094,e[4]=16,e[5]=65537,e[6]=44100,e[7]=88200,e[8]=1048578,e[9]=1635017060,e[10]=h,h+=44;for(var r=0,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a="data:audio/wav;base64,";r<h;r+=3){var k=s[r]<<16|s[r+1]<<8|s[r+2];a+=n[k>>18]+n[k>>12&63]+n[k>>6&63]+n[63&k]}return a});const c=[[0,,.1344,,.195,.4999,,,,,,,,.4824,,,,,1,,,.1,,.5],[0,,.654,.3615,.7695,.2925,,-.015,,,,.046,,.223,.539,,-.3229,,1,,,,.2159,.5],[3,,.3696,.2535,.4037,.0999,,-.0134,,,,,,,,.4544,.2196,-.1392,1,,,,,.5],[3,,.2579,.3189,.3249,.0597,,.1712,,,,-.2342,.6582,,,.4716,-.2343,-.1203,1,,,,,.5],[3,,.3455,.514,.3441,.1119,,.0362,,,,,,,,,,,1,,,,,.5],[0,,.3403,,.3456,.25,,.0916,,,,,,.137,,,,,1,,,,,.5],[0,,.3403,,.3184,.2172,.0192,.0916,,,,.0409,.0441,.1705,.01,.0017,-.0489,,1,-.0258,.0765,,,.5],[1,,.0571,,.466,.3898,,.1875,,.6209,.5363,,,,,,,,1,,,,,.5],[3,,.1384,.5,.2465,.5615,,-.615,.046,.177,,,,.5771,,,-.015,,1,,,.0472,,.5]];let l=t=>{const i=new Audio;i.src=a(c[t]),i.play()};class d{constructor(t,i,s){this.x=t,this.y=i,this.c=s,this.T=!1,this.C=!1,this.S={x:this.x+128,y:this.y+187,H:!0,D:this.x+118,N:this.y+197,O:e()},this.R=0,this.L=1,this.count=0,this.B=!1,this.F=2,this.P=0}U(t){t.drawImage(this.c[12],this.x+71,this.y+245+this.R+this.P),t.drawImage(this.c[29],this.x+181,this.y+335+this.R),t.drawImage(this.c[4],this.x,this.y+this.R),this.B||(t.fillStyle="#ffd5d5",t.fillRect(this.x+120,this.y+345+this.R,220,60)),this.C?h(t,this.c[1],this.x+108,this.y+167+this.R,this.c[1].height,this.c[1].width,0,!0):(t.drawImage(this.c[0],this.x+108,this.y+167+this.R),t.drawImage(this.c[8],this.S.x,this.S.y+this.R)),this.C?t.drawImage(this.c[1],this.x+258,this.y+167+this.R):(t.drawImage(this.c[0],this.x+258,this.y+167+this.R),t.drawImage(this.c[8],this.S.x+150,this.S.y+this.R)),t.drawImage(this.c[3],this.x+150,this.y+217+this.R),this.B||t.drawImage(this.c[9],this.x+125,this.y+360+this.R),t.drawImage(this.c[7],this.x+53,this.y+81+this.R),t.drawImage(this.c[7],this.x+363,this.y+81+this.R),t.drawImage(this.c[6],this.x+100,this.y+100+this.R),t.drawImage(this.c[6],this.x+255,this.y+100+this.R)}update(t){t.forEach(t=>{this.$(t)?t.K()?(t.V()&&t.W(),this.B=!1,this.P=0,this.T=!1,t.Y&&this.X()):(t.V()||t.J(),t.Z&&!t.T&&(t._(),l(8),this.B=!0),this.T=!0,t.Y&&this.Y()):(t.V()&&t.W(),this.T=!1,this.X())}),this.C||this.tt(),this.count>8&&(this.count=0,this.R+=this.L,(this.R>5||this.R<-5)&&(this.L*=-1)),this.count++,this.B&&(this.P+=this.F),(this.P>50||this.P<-20)&&(this.F*=-1)}$(t){return t.$(this.x+125,this.y+355+this.R,220,65)}Y(){this.C=!0}X(){this.C=!1}tt(){let t=e();if(this.S.H)this.S.x<this.S.D&&this.S.x++,this.S.x>this.S.D&&this.S.x--,this.S.y<this.S.N&&this.S.y++,this.S.y>this.S.N&&this.S.y--,this.S.x===this.S.D&&this.S.y===this.S.N&&(this.S.H=!1);else if(t-this.S.O>2e3){const t=14,i=Math.random()*Math.PI*2,s=Math.floor(Math.cos(i)*t),h=Math.floor(Math.sin(i)*t);this.S.D=this.x+s+128,this.S.N=this.y+h+187,this.S.H=!0,this.S.O=e()}}}class f{constructor(t,i,s,h,e,r,n,a){this.x=t,this.y=i,this.c=s,this.target=null;let k=this.c[h];this.it=Math.floor(k.width/2)+n,this.st=Math.floor(k.height/2)+a,this.ht=Math.floor(this.it-e/2),this.et=Math.floor(this.st-r/2),this.rt=this.x+this.ht,this.nt=this.y+this.et,this.at=e,this.kt=r}update(){this.x<-100&&(this.x=-100),this.x>1200&&(this.x=1200),this.y<-100&&(this.y=-100),this.y>650&&(this.y=650),this.rt=this.x+this.ht,this.nt=this.y+this.et,this.ot()}ct(t,i){this.target||t.lt(this.rt,this.nt,this.at,this.kt)&&(l(0),this.target=t,i||this.target.dt())}ot(){if(this.target){this.target.ot(this.rt,this.nt);let t=80;this.target.ft&&(t=this.target.ft),(this.target.K()||this.target.ut())&&this.target.nt<t&&(this.target.xt(),this.target=null)}}}class u extends f{constructor(t,i,s,h){super(t,i,s,2,30,30,0,20),this.bt=2,this.w=this.c[2].width,this.h=this.c[2].height,this.angle=90,this.wt=h,h&&(this.angle=-90),this.pt=this.x,this.vt=this.y,this.gt=this.c[2].height,this.Mt=this.c[2].width,this.Et=0}U(t){this.target&&this.target.U(t,!0),h(t,this.c[2],this.x,this.y,this.w,this.h,this.angle,this.wt)}update(t){super.update(),this.pt=this.x+50,this.vt=this.y-50,this.target||t.forEach(t=>{this.ct(t,this.wt)}),this.target&&this.target.yt&&(this.target.At=!1,this.target.reset(),this.target=null)}set(t,i,s){i>this.y?this.Et+=Math.abs(this.y-i):this.Et=0,this.Et*=s,this.y=i,this.x=t,this.pt=this.x+50,this.vt=this.y-50}move(t,i,s){null!==t&&(this.x+=t),null!==i&&(this.Gt=this.y,this.y+=i,this.y>this.Gt?this.Et+=Math.abs(this.y-this.Gt):this.Et=0,s&&(this.Et*=s))}It(i){for(let s=0;s<i.length;s++)if(!i[s].At&&t(this.pt,this.vt,this.gt,this.Mt,i[s].pt,i[s].vt,i[s].gt,i[s].Mt)>1)return{r:!0,c:this.Et,o:i[s]};return{r:!1}}push(t){let i=!1;return t.forEach(t=>{t.Tt(this.pt,this.vt,this.gt,this.Mt)&&(i=!0)}),i}}class x{constructor(t,i,s){this.x=t,this.y=i,this.c=s,this.head=new d(t+51,i-363,s),this.Ct=this.c[2].width,this.St=this.c[2].height,this.Ht=new u(this.x-300,this.y+180,s,!1),this.Dt=new u(this.x+600,this.y+180,s,!0),this.R=0,this.L=-1,this.count=2}U(t){t.drawImage(this.c[5],this.x,this.y+this.R),this.head.U(t),this.Ht.U(t),this.Dt.U(t)}update(t){this.head.update(t),this.Ht.update(t),this.Dt.update(t),this.count>8&&(this.count=0,this.R+=this.L,(this.R>5||this.R<-5)&&(this.L*=-1)),this.count++}Nt(t,i){this.Ht.move(t,i)}Ot(t,i){this.Dt.move(t,i)}}class b{constructor(t,i,s,h,e,r,n,a,k,o,c,l,d,f){this.x=t,this.y=i,this.c=s,this.Rt=n,this.At=!1;let u=this.c[h];this.it=Math.floor(u.width/2)+a,this.st=Math.floor(u.height/2)+k,this.ht=Math.floor(this.it-e/2),this.et=Math.floor(this.st-r/2),this.rt=this.x+this.ht,this.nt=this.y+this.et,this.at=e,this.kt=r,this.Lt=o,this.Bt=c,this.Ft=this.x+this.Lt,this.Pt=this.y+this.Bt,this.Ut=l,this.$t=d,this.yt=!1,this.name=f,this.jt=!1,this.Kt=!1}update(){this.rt=this.x+this.ht,this.nt=this.y+this.et,this.Ft=this.x+this.Lt,this.Pt=this.y+this.Bt}lt(i,s,h,e){return!this.At&&!this.yt&&t(i,s,h,e,this.rt,this.nt,this.at,this.kt)>=this.Rt&&(this.At=!0,!0)}ot(t,i){this.At&&(this.x=t-this.it,this.y=i-this.st,this.rt=this.x+this.ht,this.nt=this.y+this.et,this.Ft=this.x+this.Lt,this.Pt=this.y+this.Bt)}$(i,s,h,e){return!!(this.At&&t(i,s,h,e,this.Ft,this.Pt,this.Ut,this.$t)>=this.Rt)}K(){return!1}ut(){return!1}V(){return!1}J(){}W(){}xt(){}dt(){}Vt(){this.Wt("d")}Wt(t){if(!this.Kt){const i=new CustomEvent("s",{detail:{n:this.name,t}});window.dispatchEvent(i),this.Kt=!0}}Yt(){this.Wt("e")}zt(){this.Wt(null)}}const w={qt:0,Xt:1,Jt:2,EMPTY:3,Qt:4};class p extends b{constructor(t,i,s){super(t,i,s,13,60,200,2,120,20,0,60,200,80,"beers"),this.state=w.qt,this.Zt=100,this._t=e(),this.Y=!0,this.Z=!1,this.pt=this.x,this.vt=this.y,this.gt=this.c[13].width,this.Mt=this.c[13].height,this.wt=!1,this.jt=!1}U(t,i){if(this.x>1366)return;let s=13;switch(this.state){case w.Jt:s=14;break;case w.Qt:case w.EMPTY:s=15}let e=0;this.wt&&(e=300,this.Ft=this.x+this.Lt+400),this.ti()?h(t,this.c[s],this.x+e,this.y,this.c[s].width,this.c[s].height,0,this.wt):this.At&&!i||h(t,this.c[s],this.x+e,this.y,this.c[s].width,this.c[s].height,0,this.wt)}update(){super.update(),this.pt=this.x,this.vt=this.y,this.state===w.Jt&&e()>=this._t&&(this._t=e()+300,this.Zt>0&&(this.Zt-=10,l(r(5,6)))),this.ti()&&this.y<1400&&(this.y+=20),(this.ti()&&this.y>=1400||this.state===w.qt&&this.x<-400)&&this.reset()}reset(){this.jt?(this.x=3e3+r(200,300),this.y=231,this.state=w.qt,this.Zt=100,this._t=e(),this.At=!1,this.wt=!1):(this.zt(),this.yt=!0)}ti(){return this.state===w.Qt}V(){return this.state===w.Jt}J(){this.At&&this.Zt>0&&(this._t=e()+300,this.state=w.Jt)}W(){this.At&&(this.state=this.Zt>0?w.Xt:w.EMPTY)}K(){return this.Zt<=0}xt(){this.state=w.Qt,l(7)}dt(){this.wt=!0}}const v={qt:0,ii:1,si:2,hi:3,DONE:4};class g extends b{constructor(t,i,s){super(t,i,s,28,60,200,2,50,20,30,30,140,110,"sausages"),this.state=v.qt,this.Y=!1,this.Z=!0,this.pt=this.x,this.vt=this.y,this.gt=this.c[28].width,this.Mt=this.c[28].height,this.T=!1,this._t=e(),this.wt=!1,this.jt=!1}U(t,i){let s=28,e=0,r=0;switch(this.state){case v.si:s=27;break;case v.hi:s=26,e=20}this.wt&&(r=150,this.Ft=this.x+this.Lt+150,e*=-1),this.At&&!i||h(t,this.c[s],this.x+r,this.y,this.c[s].width,this.c[s].height,e,this.wt)}update(){super.update(),this.pt=this.x,this.vt=this.y,e()>this._t&&(this.T=!1),this.K()&&this.reset()}reset(){this.jt?(this.x=2300+r(200,300),this.y=231,this.pt=this.x,this.vt=this.y,this.state=v.qt,this.yt=!1,this.T=!1,this.wt=!1):(this.zt(),this.x=-400,this.yt=!0)}V(){return this.state!==v.qt}J(){this.At&&this.state===v.qt&&(this.state=v.ii)}K(){return this.state===v.DONE}xt(){this.state=v.DONE}_(){switch(this.T=!0,this.state){case v.ii:this.state=v.si;break;case v.si:this.state=v.hi;break;case v.hi:this.state=v.DONE,this.yt=!0}this._t=e()+500}dt(){this.wt=!0}}class M{constructor(t,i,s){this.x=t,this.y=i,this.c=s,this.ei=!0,this.ri=!1,this.ni=!1,this.ai=0,this.R=0,this.L=1,this.count=0,this.ki=2,this.pt=this.x+this.c[19].width-30,this.vt=this.y,this.gt=30,this.Mt=this.c[13].height,this.oi=!1,this.ci=0,this.li=["#0f0","#fff62c","#ffa500","#f00","#000"],this.di=0,this.fi=1,this.ui=13,this.xi=e()}bi(t,i,s,h,e,r,n){t.fillStyle=n,t.beginPath(),t.moveTo(i,s),t.arc(i,s,h,e,r),t.closePath(),t.fill()}U(t){t.drawImage(this.c[19],this.x,this.y-this.R),h(t,this.c[20],this.x+131,this.y+78,44,44,this.ai),h(t,this.c[20],this.x+23,this.y+78,44,44,this.ai),this.oi&&(t.drawImage(this.c[0],this.x+50,this.y-100),this.bi(t,this.x+91,this.y-100+41,37,n(-90),n(this.ci-90),this.li[this.di]))}wi(){this.oi||(this.ci=0,this.oi=!0,this.di=0,this.xi=e()+this.ui)}pi(){this.oi=!1}update(){this.count>3&&(this.count=0,this.R+=this.L,(this.R>1||this.R<0)&&(this.L*=-1)),this.count++,this.ei&&(this.ai-=this.ki,this.ai<-360&&(this.ai=0)),this.ei||e()>this.xi&&(this.ci+=this.fi,this.xi=e()+this.ui,this.ci>180&&this.ci<=270&&(this.di<1&&(this.ri=!1,this.vi()),this.di=1),this.ci>270&&this.ci<=315&&(this.di<2&&(this.ri=!1,this.vi()),this.di=2),this.ci>315&&(this.di<3&&(this.ri=!1,this.vi()),this.di=3),this.ci>=360&&(this.di<4&&(l(2),this.ni=!0),this.di=4),this.ci<=180&&(this.di=0))}It(i){for(let s=0;s<i.length;s++)if(!i[s].At&&t(this.pt,this.vt,this.gt,this.Mt,i[s].pt,i[s].vt,i[s].gt,i[s].Mt)>0)return this.vi(),this.ei=!1,this.wi(),!0;return this.ri=!1,this.ei=!0,this.pi(),!1}vi(){this.ri||(l(1),window.setTimeout(l,400,1),this.ri=!0)}}class m{constructor(t,i,s){this.x=t,this.y=i,this.Gt=i,this.c=s,this.pt=this.x,this.vt=this.y,this.gt=this.c[22].width,this.Mt=this.c[22].height,this.gi=this.y+270,this.At=!1,this.Mi=!1,this.mi=[22,36,37],this.i=22,this.wt=!1,this.Ei(),this.jt=!0,this.yt=!1,this.Wt=!1}Ei(){this.mi.length>0&&(this.i=this.mi[r(0,this.mi.length-1)])}U(t){h(t,this.c[this.i],this.x,this.y,this.gt,this.Mt,0,this.wt)}reset(){if(this.jt){this.x=1500+r(0,1e3),this.y=this.Gt,this.Mi=!1,this.Ei(),this.wt=!this.wt;const t=new CustomEvent("s",{detail:{n:"houses"}});window.dispatchEvent(t)}else if(this.yt=!0,this.Wt){const t=new CustomEvent("s",{detail:{n:"houses"}});window.dispatchEvent(t),this.Wt=!0}}update(){this.pt=this.x,this.vt=this.y,this.x<-400&&this.reset(),this.y>=this.gi-45&&this.y<this.gi-4&&this.y++}yi(t){this.y+=Math.ceil(.1*t),this.y>this.gi&&(this.y=this.gi)}}const E={qt:0,Xt:1,Ai:2,EMPTY:3,Qt:4};class y extends b{constructor(t,i,s,h,r,n,a,k){super(t,i,s,h,r-20,n-20,2,10,10,10,10,r-20,n-20,k),this.Gt=i,this.i=h,this.state=E.qt,this.Zt=100,this._t=e(),this.Y=!0,this.Z=!0,this.wt=a,this.w=r,this.h=n,this.pt=this.x,this.vt=this.y,this.gt=this.c[h].width,this.Mt=this.c[h].height,this.mi=[]}Ei(){this.mi.length>0&&(this.i=this.mi[r(0,this.mi.length-1)])}Gi(t){if(this.i>=30&&this.i<=33){let i=0;this.wt&&(i=22),h(t,this.c[20],this.x+131+i,this.y+78,44,44,0),h(t,this.c[20],this.x+23+i,this.y+78,44,44,0)}}U(t,i){if(!this.yt)return this.ti()?(h(t,this.c[this.i],this.x,this.y,this.w,this.h,0,this.wt),void this.Gi(t)):void(this.At&&!i||(h(t,this.c[this.i],this.x,this.y,this.w,this.h,0,this.wt),this.Gi(t)))}reset(){this.jt&&(this.x=1500+r(0,800),this.y=this.Gt,this.yt=!1,this.state=E.qt,this.At=!1,this.Zt=100,this._t=e(),this.wt=!this.wt,this.Ei(),this.T=!1)}update(){(!this.yt&&this.x<-200||this.yt)&&(this.Vt(),this.reset(),this.yt=!0),super.update(),this.pt=this.x,this.vt=this.y,this.state===E.Ai&&e()>=this._t&&(this._t=e()+300,this.Zt>0&&(this.Zt=0,l(5))),this.ti()&&this.y<1400&&(this.y+=20),(this.ti()&&this.y>=800||this.state===E.qt&&this.x<-400)&&(this.yt=!0),this.state===E.EMPTY&&(this.yt=!0)}ti(){return this.state===E.Qt}V(){return this.state===E.Ai}J(){this.At&&this.Zt>0&&(this._t=e()+300,this.state=E.Ai)}W(){this.At&&(this.Zt>0?this.state=E.Xt:(this.state=E.EMPTY,this.Yt()))}K(){return this.Zt<=0}ut(){return!0}xt(){this.Zt=0,this.At=!0,this.state=E.Qt,l(7),this.T=!1}_(){this.T=!0}}class A{constructor(t,i,s,h){this.x=t,this.y=i,this.w=s,this.h=h}}class G{constructor(t,i,s){this.x=t,this.y=i,this.c=s,this.Ii=!0,this.Ti=this.c[38],this.Ci=this.c[25],this.Si=[];for(let t=1;t<10;t++){let s=new A(this.x-19+48*t,i-23,39,46);s.offset=48*t,this.Si.push(s)}this.reset(t),this.pt=this.x-50,this.vt=this.y-100,this.gt=30,this.Mt=100,this.yt=!1}reset(t){this.x=t,this.ai=0,this.Hi=83-r(0,20),this.Di=!1,this.Ni=!1,this.Oi=683+r(60,200),this.yt=!1}U(t){s(t,this.Ti,this.x,this.y,this.ai,21,23),h(t,this.Ci,this.x-30,this.y-40,this.Ci.width,this.Ci.height)}update(){if(this.pt=this.x-50,this.Di)return this.vt=-100,void(this.ai>0&&(this.ai-=.5));this.vt=this.y-100,this.Si.forEach(t=>{t.x=this.x-19+t.offset*Math.cos(n(this.ai)),t.y=this.y-23+t.offset*Math.sin(n(this.ai))*-1}),this.Ni||(this.x<this.Oi&&this.ai<this.Hi&&(this.ai+=5),this.ai>=this.Hi&&(this.Ni=!0))}push(t){return this.ai+=t,this.ai<0&&(this.ai=0),this.ai>90&&(this.ai=90),this.ai<3&&(this.Di=!0,this.Wt(),!0)}Ri(){return this.push(3)}Li(){return this.push(-3)}Bi(t,i){let s=t.x+t.w/2-(i.x+i.w/2),h=t.y+t.h/2-(i.y+i.h/2),e=(t.w+i.w)/2,r=(t.h+i.h)/2,n=e*h,a=r*s,k="n";return Math.abs(s)<=e&&Math.abs(h)<=r&&(k=n>a?n>-a?"b":"l":n>-a?"r":"t"),k}Tt(i,s,h,e){if(this.Di)return!1;if(!this.Ni)return!1;for(let r=0;r<this.Si.length;r++){let n=this.Si[r];if(t(i,s,h,e,n.x,n.y,n.w,n.h)>.1){let t=this.Bi(new A(i,s,h,e),n);if("l"===t||"t"===n)return this.Li();if("b"===t||"r"===n)return this.Ri()}}return!1}Wt(){const t=new CustomEvent("s",{detail:{n:"bridges"}});window.dispatchEvent(t)}}class I extends y{constructor(t,i,s){super(t,i,s,17,153,564,!1,"trees"),this.Rt=.1,this.Y=!1,this.Z=!1,this.ft=-140,this.Fi=[],this.Pi=e(),this.Ui=25}Vt(){super.Wt(null)}Yt(){}zt(){}$(t,i,s,h){return!1}reset(){super.reset(),this.jt&&(this.x=1400,this.y=this.Gt+r(0,40),this.Fi=[],this.Ui=25)}update(){super.update(),this.At&&this.$i()}U(t,i){this.yt||(this.ti()?h(t,this.c[this.i],this.x,this.y,this.w,this.h,0,this.wt):this.At&&!i||(h(t,this.c[this.i],this.x,this.y,this.w,this.h,0,this.wt),this.At&&this.ji(t)))}ji(t){t.fillStyle="#520",this.Fi.forEach(i=>{i.yt||(t.beginPath(),t.moveTo(i.x,i.y),t.arc(i.x,i.y,i.r,0,n(360)),t.fill())})}$i(){this.Fi.forEach(t=>{t.y+=6,t.y>760&&(t.yt=!0)}),this.Fi=this.Fi.filter(t=>!t.yt),this.Fi.length<10&&e()>this.Pi&&this.Ui>0&&(this.Fi.push({x:this.x+this.w/2+r(-10,10),y:this.y+this.h-25,yt:!1,r:r(5,25)}),this.Pi=e()+100,this.Ui-=1)}}let T=[],C=null;const S={k:t=>{C.fillStyle=T[t[0]],C.strokeStyle=T[t[0]]},b:t=>{C.fillRect(t[0],t[1],t[2],t[3])},d:t=>{C.beginPath(),C.moveTo(t[0],t[1]),C.lineTo(t[2],t[3]),C.stroke()},f:t=>{C.beginPath(),C.moveTo(t[0],t[1]);for(let i=2;i<t.length;i+=2)C.lineTo(t[i],t[i+1]);C.fill()},i:t=>{C.beginPath(),C.arc(t[0],t[1],t[2],0,n(360),0),C.fill()},n:t=>{H(t[0],t[1],t[2],t[3],t[4],!0)},o:t=>{C.lineWidth=t[0]},a:t=>{C.beginPath(),C.arc(t[0],t[1],t[2],n(t[3]),n(t[4]),!0),C.fill()}},H=(t,i,s,h,e,r)=>{let n=e,a=e,k=e,o=e;C.beginPath(),C.moveTo(t+n,i),C.lineTo(t+s-a,i),C.quadraticCurveTo(t+s,i,t+s,i+a),C.lineTo(t+s,i+h-k),C.quadraticCurveTo(t+s,i+h,t+s-k,i+h),C.lineTo(t+o,i+h),C.quadraticCurveTo(t,i+h,t,i+h-o),C.lineTo(t,i+n),C.quadraticCurveTo(t,i,t+n,i),C.closePath(),r?C.fill():C.stroke()},D=t=>{T=t},N=(t,i)=>{let s=T[t];return T[t]="#"+i,s},O=(t,i,s)=>{for(let h=0;h<t.length;h++){let e=t[h].split(",");const r=e.shift();if("x"===r){if(parseInt(e[0])>0)O([].concat(t.slice(h+1)),!0,parseInt(e[0]));else if(i)return;continue}let n=e.map(Number);if(i&&s>0)switch(r){case"k":n[0]=0;break;case"n":case"b":n[0]-=s,n[1]-=s,n[2]+=2*s,n[3]+=2*s;break;case"a":case"i":n[2]+=s}S[r](n)}},R=(t,i)=>{let s=i.split(/([a-z]\,[\d+\,*]+)/).filter(t=>""!==t);if(s)return(C=t).lineWidth=1,O(s,!1,0),C},L=[80,80,"x,2k,2i,41,41,37x,0",80,80,"x,2k,3i,41,41,37x,0k,0o,2d,4,46,78,26d,8,46,78,41d,6,48,79,55",272,175,"x,2k,3i,33,50,28n,4,44,54,122,20x,0k,2i,32,45,23k,3i,33,55,28k,6n,40,19,54,151,20x,2k,3i,74,40,32n,45,45,54,122,20x,0k,2i,73,38,29k,3i,72,43,29k,6n,89,17,54,151,20x,2k,3i,126,38,33n,94,37,62,129,20x,0k,2i,128,37,31k,3i,127,45,34k,6n,145,30,53,137,20x,2k,3n,156,27,91,124,20x,0x,2k,3i,183,41,30n,151,32,64,136,20x,0k,2i,184,41,29k,3i,183,48,31k,6i,215,107,33n,207,73,53,68,20x,2k,3i,220,103,33n,216,69,53,68,20x,0",155,135,"k,4i,124,103,31i,76,106,31i,32,102,31x,2k,4i,122,91,31i,34,91,31x,0x,2k,6i,75,57,54i,75,99,27x,0k,2i,50,35,14",455,353,"x,2k,3i,52,216,50k,4i,48,219,45i,62,276,27x,0k,7n,67,151,108,156,20x,2k,3i,403,215,50k,4i,408,219,45i,396,275,27x,0k,7n,288,149,108,156,20x,2k,3i,200,434,32i,248,435,32i,230,160,157n,73,88,317,344,20x,0k,6i,360,322,5i,326,291,5i,356,267,5i,116,283,5k,7i,303,211,43i,145,214,43k,2i,173,48,22",570,500,"x,2k,11n,2,3,566,495,20k,9n,2,10,565,487,20x,0k,0o,2d,277,130,277,516k,10o,3d,279,124,280,522i,467,158,15i,484,234,29i,469,207,16i,428,310,7k,10i,281,167,28i,285,256,28i,285,350,28k,1f,152,51,282,166,441,40k,2f,164,53,282,160,426,44o,2k,0d,163,62,283,168d,436,45,280,169x,2k,14i,277,163,26k,13i,278,165,24x,0k,2i,265,147,3x,2k,14i,283,253,26k,13i,283,255,24x,0k,2i,274,236,3x,2k,14i,283,347,26k,13i,284,349,24x,0k,2i,272,330,3",105,40,"x,2k,5n,2,3,97,32,20x,0",40,105,"x,2k,5n,2,2,36,97,20x,0",43,43,"k,8i,21,22,21k,0i,21,22,11k,2i,29,15,5",208,63,"x,2k,2n,2,2,203,53,20x,0o,2k,0d,188,247,395,247d,0,26,206,26",0,0,"",0,0,"",321,247,"k,21i,136,215,32i,186,215,32n,2,15,317,200,20x,2k,3i,136,205,32i,186,205,32n,2,2,317,200,20x,0k,17k,0n,67,27,187,125,20k,29i,164,70,66x,2k,5a,139,140,41,0,180a,192,141,41,0,180x,0x,2k,14n,85,141,50,27,5n,136,136,51,29,5n,189,138,51,27,5x,0k,3b,73,152,197,35k,0d,83,152,243,152",320,445,"x,2k,2n,209,321,102,42,20n,210,123,102,42,20n,269,125,46,237,20x,0x,2k,2n,44,389,200,52,20k,0f,63,395,73,372,28,111,256,107,220,366,227,399k,2f,61,403,75,373,30,112,253,110,218,364,227,399x,0b,36,79,215,39k,13i,145,344,63i,141,123,91f,82,346,49,122,234,118,208,350k,2i,139,280,8i,114,205,5i,127,186,4i,118,151,3f,88,275,103,330,95,272,70,106,63,107f,182,340,163,389,195,348,226,110,198,103f,49,123,128,100,239,124,235,79,44,78x,2k,2i,48,108,29i,26,94,19i,76,83,19i,44,72,19i,72,59,19i,111,55,37i,123,93,19i,123,119,11i,153,65,25i,190,67,25i,220,80,19i,244,105,18i,242,79,18i,226,53,18i,202,35,18i,168,31,24i,135,32,24i,82,43,24i,55,52,24x,0",280,330,"x,2k,2i,30,54,23i,60,43,23i,93,31,23i,136,26,23i,156,49,23i,118,46,23i,171,71,23i,26,79,23x,0x,2k,2i,100,129,93x,0k,2f,9,137,24,261,179,260,193,137k,0o,2d,6,137,27,265d,194,138,176,264k,14i,99,129,76f,24,139,42,268,160,268,173,138k,2i,93,84,5i,117,119,5i,80,136,8x,2k,2n,177,98,95,39,20x,0x,2k,2n,236,98,39,118,20x,0x,2k,2n,174,182,102,39,20x,0x,2k,2i,99,233,96x,0k,14i,100,232,79k,13a,101,234,78,180,0k,2i,65,277,7i,114,255,4i,107,283,4",320,445,"x,2k,2n,209,321,102,42,20n,210,123,102,42,20n,269,125,46,237,20x,0x,2k,2n,44,389,200,52,20k,0f,63,395,73,372,28,111,256,107,220,366,227,399k,2b,31,79,222,37f,61,403,75,373,30,112,254,108,218,364,227,399x,0b,36,79,215,39k,15i,145,344,63f,82,346,40,96,243,96,208,350k,2f,182,340,163,389,195,348,231,91,198,91",320,225,"k,2i,148,62,50i,217,52,50i,270,95,50i,234,159,50i,146,159,65i,59,149,53i,106,97,53i,197,107,53",153,564,"x,2k,24b,56,277,28,194x,0x,2k,25i,91,254,53i,98,183,53i,94,119,53i,85,60,35i,66,24,22i,58,275,51i,54,207,51i,56,129,51i,56,70,36x,0k,26i,88,256,53i,61,273,53i,56,208,53i,59,129,53i,89,121,53i,94,184,53i,86,60,30i,64,26,21i,53,69,33x,2k,20i,69,512,50x,0",100,104,"k,18b,0,4,100,100k,19i,25,55,5i,17,71,2i,45,46,5i,71,77,3i,46,73,5i,92,64,2i,76,51,2k,20b,0,4,100,13k,0b,0,0,100,12k,22b,0,2,100,8k,23b,0,2,100,3",220,105,"x,2k,2n,4,2,180,3,2k,29n,37,99,119,4,2k,28n,5,7,179,91,5f,185,6,167,98,205,98,206,59x,0k,27b,5,54,200,9k,0o,2d,205,60,184,3d,207,57,207,93x,2k,2i,201,62,6k,29n,187,77,20,24,5n,2,77,13,23,5k,17n,4,58,11,13,5x,0k,14n,12,12,104,38,5x,2k,29a,153,98,24,0,180a,45,98,24,0,180k,16n,130,12,45,36,5x,0k,0f,180,51,179,8,195,49k,16f,181,48,180,10,194,48k,0o,2d,195,51,180,9",44,44,"k,0i,22,22,22k,12i,23,22,10k,21i,23,6,3",30,40,"k,8f,2,3,1,37,14,33f,16,1,8,37,19,33f,28,6,13,34,25,34k,0o,2d,2,3,11,23d,2,3,1,40d,16,0,10,25d,16,0,19,26d,28,3,19,26d,28,3,26,37",255,375,"x,2k,17n,2,2,251,98,20k,2b,2,15,251,272k,21b,2,269,251,100x,0x,2k,19n,19,150,61,109,10x,2k,12i,69,212,3k,16n,97,149,143,58,10n,97,42,60,58,10n,19,42,60,58,10n,97,41,60,58,10n,180,41,60,58,10k,1b,14,257,70,10x,0k,21b,1,15,252,5k,15b,108,149,12,58b,188,42,12,56b,106,42,12,58b,27,42,12,58k,3b,11,2,233,3k,0o,2d,1,14,254,14",210,152,"k,0n,54,37,8,44,2x,2k,27b,101,6,79,63n,17,62,177,57,20x,0x,2k,21n,49,116,85,3,4n,40,72,48,24,5a,166,119,50,325,190k,1b,141,13,35,46x,0k,0i,28,125,27i,165,114,39o,2d,117,109,209,90k,13i,165,114,18i,28,125,13x,2k,2i,18,82,5k,2n,98,2,85,4,4x,0k,27f,103,8,88,69,112,69k,0f,137,13,137,62,116,71,96,71,106,14k,1f,136,15,136,58,118,69,97,69,108,16k,0o,2d,102,9,89,67",51,44,"x,2k,19n,2,4,47,35,5x,0k,19b,-1,6,32,30x,2k,18i,26,22,20x,0k,33i,26,22,17k,32i,26,22,15k,33i,26,22,13k,32i,26,22,10k,33i,26,22,9k,32i,26,22,5k,33i,26,22,3",52,137,"x,2k,19i,25,25,23b,2,29,47,104x,0k,18i,24,27,23b,2,29,45,107k,19i,25,31,10k,1i,25,31,4",152,312,"k,0f,1,269,83,228,49,312k,19f,6,268,78,237,48,308x,2k,19i,70,218,52x,0k,0f,20,201,43,134,42,69,151,66,152,158,118,245k,24f,21,206,46,131,42,69,148,66,149,157,117,245k,19f,21,206,44,130,42,69,148,66,149,157,117,245x,2k,24i,73,61,30i,119,59,30i,93,33,30x,0k,2i,78,75,4i,99,18,3k,34i,124,41,4i,62,53,7i,99,49,6i,124,73,2",152,445,"k,0f,1,402,83,361,49,445k,19f,6,401,78,370,48,441x,2k,19i,70,351,52x,0k,0f,20,334,43,267,27,75,134,44,152,201,151,292,117,382k,24f,21,339,46,264,29,69,132,41,149,197,150,290,113,387k,19f,21,339,44,263,30,81,127,36,145,201,147,292,113,388x,2k,24i,56,69,30i,101,54,30i,66,34,30x,0k,2i,65,71,4i,58,32,3k,34i,81,49,4i,46,63,7i,111,42,6i,101,65,2",175,522,"k,0f,24,479,106,438,72,522f,35,3,65,61,1,36k,19f,29,478,101,447,71,518f,36,5,60,57,5,36x,2k,19i,93,428,52i,77,86,52x,0k,0f,43,411,66,344,50,152,23,100,121,52,157,121,175,278,174,369,140,459k,24f,44,416,69,341,61,151,47,112,120,54,153,119,172,274,173,367,136,464k,19f,44,416,67,340,55,156,25,98,113,48,150,115,168,278,170,369,136,465k,24i,89,60,12k,17",111,34,"x,2k,14n,2,2,51,29,5n,58,1,51,31,5x,0k,0d,0,19,112,19"],B=["#000","#ccc","#fff","#ffd5d5","#faa","#c83737","#ff9191","#ff8080","#080","#a6cda6","#85ba85","#e6f1e6","#fd5","#ffe381","#fff6d5","#d5f6ff","#aef","#ff2a2a","#830","#a40","#520","#666","#59eb59","#a2f4a2","#d38d5f","#abc837","#677821","#3c3cff","#f60","#4d4d4d","#009a9a","#00cbcb","#deaa87","#fca","#c87137"],F={Ki:461,Vi:100},P={Vi:673,Ki:692,Wi:404,Yi:230,zi:231,qi:553,Xi:530,Ji:231,Qi:646};class U{constructor(t){this.Zi=t,this._i=0,this.offset=0,this.ts=[{g:2},{g:1},{h:25,g2:3},{h:50,g2:4},{g:1,b:!0},{t:1,g:1},{t:1,g:2},{s:1,g:2},{d:1,g:2},{v:1,g:2},{e:1,g:3},{v:1,g:3},{e:1,g:2}],this.ss=-1,this.speed=2,this.Tt=[],this.yi=[],this.hs=[],this.push=[],this.es=[],this.rs=[],this.ns=[],this.as=[],this.ks=!1,this._t=e(),this.os=-10,this.cs=.25}init(){for(let t=0;t<6;t++)this.ls(!0,0);this.ls(!0,9),this.ls(!0,2),this.ls(!0,0),this.ls(!0,10),this.ls(!0,5),this.ls(!0,0),this.ls(!0,8)}update(){this.ks||(this.offset-=this.speed,this.ns.forEach(t=>{t.x-=this.speed}),this.as.forEach(t=>{t.x-=this.speed}),this.es.forEach(t=>{t.x-=this.speed}),this.rs.forEach(t=>{t.x-=this.speed})),this.as.forEach(t=>{t.update()}),this.es.forEach(t=>{t.update()}),this.Tt=this.Tt.filter(t=>!t.yt),this.yi=this.yi.filter(t=>!t.yt),this.hs=this.hs.filter(t=>!t.yt),this.ns=this.ns.filter(t=>t.x>-100),this.rs=this.rs.filter(t=>t.x>-100),this.os+=this.cs,(this.os>15||this.os<-15)&&(this.cs*=-1),this._t<e()&&(this.ls(),this._t=e()+500)}U(t){t.fillStyle="#aef",t.fillRect(0,740,1366,30),this.es.forEach(i=>{i.U(t)}),this.rs.forEach(i=>{h(t,this.Zi[21],i.x,i.y,this.Zi[21].width,this.Zi[21].height,this.os)}),this.ns.forEach(i=>{t.drawImage(this.Zi[18],i.x,i.y)}),this.as.forEach(i=>{i.U(t)})}ls(t,i){let s=r(0,this.ts.length-1);for(;s===this.ss;)s=r(0,this.ts.length-1);t&&(s=i),this.ss=s;let h=this.ts[s];Object.keys(h).forEach(t=>{let i=h[t];switch(t){case"g":for(let t=0;t<i;t++)this.ns.push({x:this._i+this.offset,y:P.Vi}),r(0,1)>0&&this.rs.push({x:this._i+this.offset+r(0,60),y:P.Qi}),this._i+=F.Vi;break;case"g2":for(let t=0;t<i;t++)this.ns.push({x:this._i+this.offset,y:P.Vi}),this._i+=F.Vi;break;case"b":let s=new G(this._i+this.offset,P.Ki,this.Zi);this.as.push(s),this.push.push(s),this.Tt.push(s),this._i+=F.Ki;break;case"h":let h=new m(this._i+this.offset,P.Wi,this.Zi);h.jt=!1,this.as.push(h),this.yi.push(h),this.Tt.push(h);break;case"t":let e=new I(this._i+this.offset,P.Yi,this.Zi);e.jt=!1,this.es.push(e),this.hs.push(e),this.Tt.push(e);break;case"d":let n=new p(this._i+this.offset,P.zi,this.Zi);n.jt=!1,this.es.push(n),this.hs.push(n),this.Tt.push(n);break;case"s":let a=new g(this._i+this.offset,P.Ji,this.Zi);a.jt=!1,this.es.push(a),this.hs.push(a),this.Tt.push(a);break;case"v":let k=Math.random()<.5,o=new y(this._i+this.offset,P.qi,this.Zi,30,this.Zi[30].width,this.Zi[30].height,k,"vans");o.mi=[30,31,32,33],o.Ei(),o.jt=!1,this.es.push(o),this.hs.push(o),this.Tt.push(o);break;case"e":let c=Math.random()<.5,l=new y(this._i+this.offset,P.Xi,this.Zi,23,this.Zi[23].width,this.Zi[23].height,c,"tractors");l.mi=[23,34,35],l.Ei(),l.jt=!1,this.es.push(l),this.hs.push(l),this.Tt.push(l)}})}}const $={LOADING:0,TITLE:1,STORY:2,CONTROLS:3,HOWTO:4,GAME:5,GAMEOVER:6},j=1,K=1;class V{constructor(t,i){this.ds={},this.Zi=[],this.state=$.LOADING,this.text=[["*HANS FIXES","*THE INTERNET","","made for js13k 2018","","code & art by","madmarcel","","best played with the dual analog","sticks on a gamepad"],["*Oh no!","Hans the Giants internet connection has broken.","He can't visit his favourite site:","www.giantsausages.com","Hans is very upset","","The ISP has sent a very impatient man in an","orange van to fix Hans' internet","","Don't make him wait",""],["*Hand Controls","Use either","","dual analog stick on gamepad","","or","","mouse + arrow keys","","to control Hans the Giants fists",""],["*How to Giant","Don't keep the man in the van waiting too long!","","Smash buildings, flatten bridges.","","Eat or chuck cars & tractors","(Raise things to top of screen to chuck)","","Chuck trees - no veggies for Hans ;)","","Eat and drink all the beer and sausages (Huzzah!)"],["*GAME OVER","You have","-----------","","","","","","",""]],window.addEventListener("s",t=>{let i=t.detail.n,s=t.detail.t;s?this.fs[i][s]+=1:this.fs[i]+=1}),this.us=[[19,27,"2c84a6",28,"8ce724",14,"ee360d"],[19,27,"fff",28,"fff",14,"fff"],[19,27,"000",28,"ccc",14,"fff"],[19,27,"fff",28,"f00",14,"fff"],[23,27,"f00"],[23,27,"648e06",12,"648e06"],[22,19,"0055d4",2,"ffd5d5",17,"0055d4",3,"acf",1,"fff"],[22,19,"080",2,"deaa87",17,"080",3,"afa",1,"fff"]]}init(){this.fs={vans:{e:0,d:0},tractors:{e:0,d:0},trees:0,houses:0,bridges:0,beers:0,sausages:0},this.speed=2,this.os=-10,this.cs=.25,this.level=new U(this.Zi),this.level.init(),this.xs=new x(428,345,this.Zi),this.bs=new M(20,553,this.Zi),this.ws=new I(1700,230,this.Zi),this.ps=-10,this.vs=-40,this.gs=-10,this.ks=!1,CanvasRenderingContext2D.prototype.Ms=((t,i,s)=>{let h=t.getImageData(0,0,1366,768);t.fillStyle="black",t.fillRect(0,0,1366,768),t.putImageData(h,i,s)}),this.trees=[];for(let t=0;t<4;t++)this.trees.push({x:t*r(300,400)+r(-50,100),y:300+r(0,40)});this.ms=[];for(let t=0;t<4;t++)this.ms.push({x:t*r(200,1600),y:20+r(0,40)});this.Es={},this.ys(),this.As(),this.Gs=!1,this.Is=0,this.Ts=0}Cs(t,s,h,e){t.globalAlpha=.8,t.fillStyle="#000",t.fillRect(450,100,466,568),t.globalAlpha=1;let r=200,n=36,a=18,k="#f80";s.forEach(s=>{n=36;let h=s;"*"===s[0]&&(a=48,h=s.substr(1),n=60,k="#f80"),i(t,h,683,r,k,a,!0),a=18,r+=n,k="#fff"}),i(t,h,583,r+18,"#ff0",a,!0),i(t,e,783,r+18,"#ff0",a,!0)}Ss(t,i,s,h){this.Hs(t),this.Cs(t,this.text[i],s,h),this.ws&&this.ws.U(t),this.Ds(t),this.Ns&&this.Ns.U(t)}Os(t){this.Ss(t,0,"play","story")}Rs(t){this.Ss(t,1,"play","controls")}Ls(t){this.Ss(t,2,"play","how to play")}Bs(t){this.Ss(t,3,"controls","play")}Fs(t){this.Hs(t),this.xs.U(t),this.bs.U(t),this.level.U(t),this.Gs&&(t.Ms(t,0,r(-25,25)),e()>=this.Is&&(this.Gs=!1))}Ps(t){this.Ss(t,4,"title","replay")}U(t){switch(this.state){case $.TITLE:this.Os(t);break;case $.STORY:this.Rs(t);break;case $.CONTROLS:this.Ls(t);break;case $.HOWTO:this.Bs(t);break;case $.GAME:this.Fs(t);break;case $.GAMEOVER:this.Ps(t)}}Hs(t){this.Us(t),this.$s(t,this.ds.js,6,360,this.ps),this.$s(t,this.ds.Ks,6,460,this.vs),this.Vs(t)}Ds(t){this.Ws(t,15,646,this.gs),this.Ys(t,15,673,this.gs)}$s(t,i,s,e,r){for(let n=0;n<s;n++)h(t,i,300*n+r,e)}Ws(t,i,s,e){for(let r=0;r<i;r++)h(t,this.Zi[21],100*r+e,s,this.Zi[21].width,this.Zi[21].height,this.os)}Ys(t,i,s,h){t.fillStyle="#aef",t.fillRect(0,740,1366,30);for(let e=0;e<i;e++)t.drawImage(this.Zi[18],100*e+h,s)}Vs(t){t.fillStyle="#077",t.fillRect(0,665,1366,108);for(let i=0;i<this.trees.length;i++)h(t,this.ds.zs,this.trees[i].x,this.trees[i].y,void 0,void 0,0,!1,.6)}Us(t){for(let i=0;i<this.ms.length;i++)h(t,this.Zi[16],this.ms[i].x,this.ms[i].y,320,225,-10)}update(){switch(this.state){case $.GAME:this.qs();break;default:this.Xs()}}Xs(){this.ps-=this.speed/8,this.vs-=this.speed/4,this.gs-=this.speed;for(let t=0;t<this.trees.length;t++)this.trees[t].x-=this.speed,this.trees[t].x<-500&&(this.trees[t].x+=r(2e3,4e3)+r(-40,40));this.ps<-310&&(this.ps=-10),this.vs<-340&&(this.vs=-40),this.gs<-110&&(this.gs=-10),this.os+=this.cs,(this.os>15||this.os<-15)&&(this.cs*=-1);for(let t=0;t<this.ms.length;t++)this.ms[t].x-=.1,this.ms[t].x<-500&&(this.ms[t].x+=r(2e3,4e3)+r(-40,40));this.ws&&(this.ws.x-=this.speed,this.ws.x<-300&&(this.ws.x=1700)),this.Ns&&(this.Ns.x-=this.speed,this.Ns.x<-300&&(this.Ns.x=3400,this.Ns.Ei()))}qs(){if(this.Js(),this.Qs(),this.xs.update(this.level.hs),this.bs.update(),this.level.update(),this.bs.It(this.level.Tt)?(this.ks=!0,this.level.ks=!0):(this.ks=!1,this.level.ks=!1),!this.ks){this.ps-=this.speed/8,this.vs-=this.speed/4,this.gs-=this.speed;for(let t=0;t<this.trees.length;t++)this.trees[t].x-=this.speed,this.trees[t].x<-500&&(this.trees[t].x+=r(2e3,4e3)+r(-40,40));this.level.speed=this.speed}this.ps<-310&&(this.ps=-10),this.vs<-340&&(this.vs=-40),this.gs<-110&&(this.gs=-10,this.Ts>40&&(this.speed++,this.bs.ki+=.5,this.Ts=0),this.Ts++);for(let t=0;t<this.ms.length;t++)this.ms[t].x-=.1,this.ms[t].x<-500&&(this.ms[t].x+=r(2e3,4e3)+r(-40,40));let t=this.xs.Ht.It(this.level.yi),i=this.xs.Dt.It(this.level.yi);t.r&&this.Zs(t.o,t.c),i.r&&this.Zs(i.o,i.c),(this.xs.Ht.push(this.level.push)||this.xs.Dt.push(this.level.push))&&(l(r(2,4)),this._s(150)),this.bs.ni&&(this.th(),this.state=$.GAMEOVER)}Zs(t,i){i>10&&(t.yi(i),l(r(2,4)),this._s(200),t.Mi=!1)}_s(t){this.Gs=!0,this.Is=e()+t}ih(t,i){this.sh(t=Math.floor(t),i=Math.floor(i))}hh(t,i){this.eh(t=Math.floor(t),i=Math.floor(i))}eh(t,i){if(this.state===$.GAME){this.xs.Dt.set(t,i,K);let s=this.xs.Dt.It(this.level.yi);s.r&&this.Zs(s.o,s.c)}}sh(t,i){const s=683;switch(this.state){case $.TITLE:t>s?this.state=$.STORY:(this.init(),this.state=$.GAME);break;case $.STORY:t>s?this.state=$.CONTROLS:(this.init(),this.state=$.GAME);break;case $.CONTROLS:t>s?this.state=$.HOWTO:(this.init(),this.state=$.GAME);break;case $.HOWTO:t>s?(this.init(),this.state=$.GAME):this.state=$.CONTROLS;break;case $.GAMEOVER:t>s?(this.init(),this.state=$.GAME):this.state=$.TITLE}}th(){let t=Object.keys(this.fs),i="chucked";for(let s=3;s<10;s++){let h=t[s-3];s<5?this.text[4][s]=`chucked ${this.fs[h].d} ${h} and eaten ${this.fs[h].e} ${h}`:(5==s&&(i="chucked"),s>5&&s<8&&(i="smashed"),8==s&&(i="drank"),9==s&&(i="eaten"),this.text[4][s]=`${i} ${this.fs[h]} ${h}`)}}As(){this.rh={},window.onkeyup=(t=>{this.rh[t.keyCode]=!1}),window.onkeydown=(t=>{this.rh[t.keyCode]=!0})}nh(t){return this.rh[t]}Qs(){let t=null,i=null;(this.nh(37)||this.nh(65))&&(t=-15),(this.nh(39)||this.nh(68))&&(t=15),(this.nh(38)||this.nh(87))&&(i=-15),(this.nh(40)||this.nh(83))&&(i=15),this.xs.Ht.move(t,i,j)}ah(t,i,s,h){this.xs.Ht.move(t,i),this.xs.Dt.move(s,h)}kh(t){let i=0;return t>.2&&(i=6),t>.5&&(i=12),t>.9&&(i=24),t<-.2&&(i=-6),t<-.5&&(i=-12),t<-.9&&(i=-24),i}oh(t,i){let s=null,h=null,e=null,r=null;switch(t){case 0:s=this.kh(i);break;case 1:h=this.kh(i);break;case 2:e=this.kh(i);break;case 3:r=this.kh(i)}this.ah(s,h,e,r)}Js(){let t=navigator.getGamepads();Array.isArray(t)||(this.Es=t),Object.keys(this.Es).forEach(t=>{let i=this.Es[t];if(null!==i&&i.axes)for(let t=0;t<i.axes.length;t++){let s=i.axes[t];i.axes[t].value&&(s=i.axes[t].value),this.oh(t,s)}})}lh(t,i){const s=t.gamepad,h=s.index;try{i?this.Es[h]=s:delete this.Es[h]}catch(t){}}ys(){let t=this;navigator.getGamepads&&(window.addEventListener("gamepadconnected",i=>{t.lh(i,!0)},!1),window.addEventListener("gamepaddisconnected",i=>{t.lh(i,!1)},!1))}start(){D(B);let t=L;for(let i=0;i<t.length;i+=3){let s=t[i],h=t[i+1],e=t[i+2],[r,n]=this.dh(s,h);R(r,e),this.Zi.push(n)}this.us.forEach(i=>{let s=3*i[0];for(let t=1;t<i.length;t+=2)N(i[t],i[t+1]);this.Zi.push(this.fh(t[s+2],t[s],t[s+1])),D(B)}),this.Zi.push(this.uh(this.Zi[24]));let i=L[51],s=L[52],h=L[53],e=B[30];this.ds.js=this.xh(B[31],h,i,s),this.ds.Ks=this.xh(e,h,i,s),this.ds.zs=this.xh("#077",h,i,s),this.ds.js=this.bh(this.ds.js),this.ds.Ks=this.bh(this.ds.Ks),this.state=$.TITLE,this.init()}fh(t,i,s){let[h,e]=this.dh(i,s);return R(h,t),e}xh(t,i,s,h){return D(this.wh(B,t)),this.fh(i,s,h)}uh(t){let[i,s]=this.dh(484,44);for(let s=0;s<10;s++)h(i,t,48*s,0,t.width,t.height);return s}bh(t){let[i,s]=this.dh(380,300);for(let s=0;s<4;s++)for(let e=0;e<6;e++){let n=r(0,50);h(i,t,60*e,50*s+n,76,236)}return s}wh(t,i){for(let s=0;s<t.length;s++)t[s]=i;return t}dh(t,i){let s=document.createElement("canvas");return s.width=t,s.height=i,[s.getContext("2d"),s]}}window.addEventListener("load",()=>{const t=document.getElementById("c"),i=t.getContext("2d");let s=new V,h=()=>{s.update(),i.clearRect(0,0,1366,768),s.U(i),requestAnimationFrame(h)};var e;(e=t).addEventListener("click",t=>{let i=e.getBoundingClientRect();s.ih(t.clientX-i.left,t.clientY-i.top)},!1),e.addEventListener("mousemove",t=>{let i=e.getBoundingClientRect();s.hh(t.clientX-i.left,t.clientY-i.top)},!1),s.start(),h()})}();</script>